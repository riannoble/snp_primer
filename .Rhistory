df[[4]] <- extract_top_n(df[[4]], top)
df[[5]] <- extract_top_n(df[[5]], top)
# Technical debt
df <- df[!duplicated(df$snpID), ]
df <- df %>%
group_by(snpID) %>%
filter(substrings_count == max(substrings_count))
print(df)
level5 <- soulofmultiplex(df, Heterodimer_tm)
print(level5)
level5_with_tm_result <- get_tm_for_all_primers(level5) # What is this fxn??
result <- get_multiplex(df, Heterodimer_tm, top)
tkmessageBox(message = paste("The result is:", result))
install.packages("svDialigs")
install.packages("svDialogs")
library(svDialogs)
winDialog(type = "message", message = paste("Result:", result))
winDialog(type = "message", message = paste("Result:", result))
findacorn <- function(primer, shift, desired_tm, diff, Heterodimer_tm, Homodimer, top, hairpin){
mart_api(primer, shift)
get_filter(df, desired_tm, diff, Heterodimer_tm, Homodimer, hairpin) # unexplained error?
result <- get_multiplex(df, Heterodimer_tm, top)
shinyString <- paste("<textarea id='copyableTextArea' rows='5' cols='50' readonly>", result, "</textarea>")
return(shinyString)
}
result <- get_multiplex(df, Heterodimer_tm, top)
shinyString <- paste("<textarea id='copyableTextArea' rows='5' cols='50' readonly>", result, "</textarea>")
return(shinyString)
shinyString
library(htmltools)
# Example HTML content
html_content <- '
<!DOCTYPE html>
<html>
<head>
<title>HTML Output</title>
</head>
<body>
<h1>',result,'</h1>
# Example HTML content
html_template <- paste0('
<!DOCTYPE html>
<html>
<head>
<title>HTML Output</title>
</head>
<body>
<h1>', result, '</h1>
<p>This is an example of HTML output displayed in RStudio.</p>
</body>
</html>
')
# Display HTML content in RStudio Viewer pane
html_print(html_content)
# Display HTML content in RStudio Viewer pane
html_print(html_template)
# Example HTML content
html_template <- paste0('
<!DOCTYPE html>
<html>
<head>
<title>HTML Output</title>
</head>
<body>
<h1>', result, '</h1>
<p>This is an example of HTML output displayed in RStudio.</p>
</body>
</html>
', collapse = "")
# Display HTML content in RStudio Viewer pane
html_print(html_template)
# Display HTML content in RStudio Viewer pane
html_print(result)
# Display HTML content in RStudio Viewer pane
html_print(result)
# Example HTML content
html_template <- paste0(result, collapse = "")
# Display HTML content in RStudio Viewer pane
html_print(html_template)
findacorn <- function(primer, shift, desired_tm, diff, Heterodimer_tm, Homodimer, top, hairpin){
mart_api(primer, shift)
get_filter(df, desired_tm, diff, Heterodimer_tm, Homodimer, hairpin) # unexplained error?
result <- get_multiplex(df, Heterodimer_tm, top)
# Example HTML content
html_template <- paste0(result, collapse = "")
# Display HTML content in RStudio Viewer pane
html_print(html_template)
}
findacorn(primer, shift, desired_tm, diff, Heterodimer_tm, Homodimer, top, hairpin)
?appendConsole
??appendConsole
require("biomaRt")
# We will start exploring options 800 bp away from the SNP location upstream and downstream
center <- 800
hairpin <- 45
# from that distance of 800, we will search the range from 600 to 1,000. (800+200 and 800-200)
far <- 200
start_distance <- 15
end_distance <- 28
# Accessing database
print("Execute MART API")
snp_list <- strsplit(primer, " ")[[1]]
upStream <- center
downStream <- center
snpmart <- useMart("ENSEMBL_MART_SNP", dataset = "hsapiens_snp") # possibly establish earlier?
snp_sequence <- getBM(attributes = c('refsnp_id', 'snp'),
filters = c('snp_filter', 'upstream_flank', 'downstream_flank'),
checkFilters = FALSE,
values = list(snp_list, upStream, downStream),
mart = snpmart,
bmHeader = TRUE)
#Create a new data frame
snp_wrangled <- data.frame(matrix(ncol = 2, nrow = 0))
# Add each variation as a new string into each row
for (j in snp_sequence$`Variant name`){
for (i in list_seq(snp_sequence$`Variant sequences`[snp_sequence$`Variant name`==j])){
snp_wrangled[nrow(snp_wrangled) + 1,] <- c(j, i)
}
}
# Rename columns and data frame
colnames(snp_wrangled) = c("snpID", "sequence")
### I have a long long string. I want to get the left 18~25 charactors and
# between 300 ~ 800 units away, I want another 18 ~ 25
df <- all_text_wrangling(snp_wrangled,
start_distance,
end_distance,
center,
far,
shift)
df
print("Primer generated")
print("R get filter activated")
# Applied filters before multiplexing
df <- stage1_filter(df, desired_tm, diff, Homodimer, hairpin)
print(df)
print("Filtered")
# Count how many candidates there are for each primer group
df <- df %>%
mutate(substrings_count = lengths(substrings),
faraway_count = lengths(faraway)) %>%
relocate(snpID, substrings_count, faraway_count, everything()) # Moves a block of columns
print("Tree search")
df
# Keep only certain amount of candidates
df[[4]] <- extract_top_n(df[[4]], top)
df[[5]] <- extract_top_n(df[[5]], top)
# Technical debt
df <- df[!duplicated(df$snpID), ]
df <- df %>%
group_by(snpID) %>%
filter(substrings_count == max(substrings_count))
print(df)
level5 <- soulofmultiplex(df, Heterodimer_tm)
level5_with_tm_result <- get_tm_for_all_primers(level5) # What is this fxn??
findacorn <- function(primer, shift, desired_tm, diff, Heterodimer_tm, Homodimer, top, hairpin){
df <- mart_api(primer, shift)
df <- get_filter(df, desired_tm, diff, Heterodimer_tm, Homodimer, hairpin) # unexplained error?
result <- get_multiplex(df, Heterodimer_tm, top)
# Example HTML content
html_template <- paste0(result, collapse = "")
# Display HTML content in RStudio Viewer pane
html_print(html_template)
}
findacorn(primer, shift, desired_tm, diff, Heterodimer_tm, Homodimer, top, hairpin)
df <- mart_api(primer, shift)
primer = "rs53576, rs1815739, rs7412, rs429358, rs6152"
shift = 100
desired_tm = 64
diff = 3
Heterodimer_tm = 50
Homodimer <- 45
top <- 2
hairpin <- 45
findacorn(primer, shift, desired_tm, diff, Heterodimer_tm, Homodimer, top, hairpin)
df <- mart_api(primer, shift)
# FUNCTION - Primer Generator
mart_api <- function(primer,
shift){
# We will start exploring options 800 bp away from the SNP location upstream and downstream
center <- 800
hairpin <- 45
# from that distance of 800, we will search the range from 600 to 1,000. (800+200 and 800-200)
far <- 200
start_distance <- 15
end_distance <- 28
# Accessing database
print("Execute MART API")
snp_list <- strsplit(primer, " ")[[1]]
print("snp_list generated")
upStream <- center
print("upstream")
downStream <- center
print("downstream")
snpmart <- useMart("ENSEMBL_MART_SNP", dataset = "hsapiens_snp") # possibly establish earlier?
snp_sequence <- getBM(attributes = c('refsnp_id', 'snp'),
filters = c('snp_filter', 'upstream_flank', 'downstream_flank'),
checkFilters = FALSE,
values = list(snp_list, upStream, downStream),
mart = snpmart,
bmHeader = TRUE)
#Create a new data frame
snp_wrangled <- data.frame(matrix(ncol = 2, nrow = 0))
# Add each variation as a new string into each row
for (j in snp_sequence$`Variant name`){
for (i in list_seq(snp_sequence$`Variant sequences`[snp_sequence$`Variant name`==j])){
snp_wrangled[nrow(snp_wrangled) + 1,] <- c(j, i)
}
}
# Rename columns and data frame
colnames(snp_wrangled) = c("snpID", "sequence")
### I have a long long string. I want to get the left 18~25 charactors and
# between 300 ~ 800 units away, I want another 18 ~ 25
df <- all_text_wrangling(snp_wrangled,
start_distance,
end_distance,
center,
far,
shift)
df
print("Primer generated")
return(df)
}
findacorn <- function(primer, shift, desired_tm, diff, Heterodimer_tm, Homodimer, top, hairpin){
df <- mart_api(primer, shift)
df <- get_filter(df, desired_tm, diff, Heterodimer_tm, Homodimer, hairpin) # unexplained error?
result <- get_multiplex(df, Heterodimer_tm, top)
# Example HTML content
html_template <- paste0(result, collapse = "")
# Display HTML content in RStudio Viewer pane
html_print(html_template)
}
primer = "rs53576, rs1815739, rs7412, rs429358, rs6152"
shift = 100
desired_tm = 64
diff = 3
Heterodimer_tm = 50
Homodimer <- 45
top <- 2
hairpin <- 45
findacorn(primer, shift, desired_tm, diff, Heterodimer_tm, Homodimer, top, hairpin)
install.packages("devtools")
library(devtools)
install_github("rianoble/acornfinder")
library(acornfinder)
findacorn(primer, shift, desired_tm, diff, Heterodimer_tm, Homodimer, top, hairpin)
#BiocManager::install("rprimer")
require("rprimer")
#library(Biostrings)
require("htmltools")
# Data processing
require("DT")
require("dplyr")
require("tidyverse")
require("stringi")
require("stringr")
require("mosaic")
require("purrr")
#graphing
require("ggplot2")
require("hexbin")
require("patchwork")
require("plotly")
# Bioinformatics
require("BiocManager")
require("biomaRt")
require("spgs")
require("primer3")
findacorn(primer, shift, desired_tm, diff, Heterodimer_tm, Homodimer, top, hairpin)
snpmart <- useMart("ENSEMBL_MART_SNP", dataset = "hsapiens_snp")
# FUNCTION - Primer Generator
mart_api <- function(primer,
shift){
# We will start exploring options 800 bp away from the SNP location upstream and downstream
center <- 800
hairpin <- 45
# from that distance of 800, we will search the range from 600 to 1,000. (800+200 and 800-200)
far <- 200
start_distance <- 15
end_distance <- 28
# Accessing database
print("Execute MART API")
snp_list <- strsplit(primer, " ")[[1]]
print("snp_list generated")
upStream <- center
print("upstream")
downStream <- center
print("downstream")
#snpmart <- useMart("ENSEMBL_MART_SNP", dataset = "hsapiens_snp") # possibly establish earlier?
snp_sequence <- getBM(attributes = c('refsnp_id', 'snp'),
filters = c('snp_filter', 'upstream_flank', 'downstream_flank'),
checkFilters = FALSE,
values = list(snp_list, upStream, downStream),
mart = snpmart,
bmHeader = TRUE)
#Create a new data frame
snp_wrangled <- data.frame(matrix(ncol = 2, nrow = 0))
# Add each variation as a new string into each row
for (j in snp_sequence$`Variant name`){
for (i in list_seq(snp_sequence$`Variant sequences`[snp_sequence$`Variant name`==j])){
snp_wrangled[nrow(snp_wrangled) + 1,] <- c(j, i)
}
}
# Rename columns and data frame
colnames(snp_wrangled) = c("snpID", "sequence")
### I have a long long string. I want to get the left 18~25 charactors and
# between 300 ~ 800 units away, I want another 18 ~ 25
df <- all_text_wrangling(snp_wrangled,
start_distance,
end_distance,
center,
far,
shift)
df
print("Primer generated")
return(df)
}
snpmart <- useMart("ENSEMBL_MART_SNP", dataset = "hsapiens_snp")
findacorn(primer, shift, desired_tm, diff, Heterodimer_tm, Homodimer, top, hairpin)
df <- mart_api(primer, shift)
df <- get_filter(df, desired_tm, diff, Heterodimer_tm, Homodimer, hairpin) # unexplained error?
result <- get_multiplex(df, Heterodimer_tm, top)
# Example HTML content
html_template <- paste0(result, collapse = "")
# Split the output string into rows
output_rows <- strsplit(output_string, "-1.000e+06", fixed = TRUE)[[1]]
# Split the output string into rows
output_rows <- strsplit(html_template, "-1.000e+06", fixed = TRUE)[[1]]
# Convert rows into a list of elements
output_elements <- strsplit(output_rows, " ")
# Convert list into a matrix
output_matrix <- do
# Display HTML content in RStudio Viewer pane
html_print(html_template)
findacorn <- function(primer, shift, desired_tm, diff, Heterodimer_tm, Homodimer, top, hairpin){
df <- mart_api(primer, shift)
df <- get_filter(df, desired_tm, diff, Heterodimer_tm, Homodimer, hairpin) # unexplained error?
result <- get_multiplex(df, Heterodimer_tm, top)
# Example HTML content
html_template <- paste0(result, collapse = "")
# Split the output string into rows
output_rows <- strsplit(html_template, "-1.000e+06", fixed = TRUE)[[1]]
# Convert rows into a list of elements
output_elements <- strsplit(output_rows, " ")
# Convert list into a matrix
output_matrix <- do
# Display HTML content in RStudio Viewer pane
html_print(html_template)
}
findacorn(primer, shift, desired_tm, diff, Heterodimer_tm, Homodimer, top, hairpin)
findacorn(primer, shift, desired_tm, diff, Heterodimer_tm, Homodimer, top, hairpin)
findacorn <- function(primer, shift, desired_tm, diff, Heterodimer_tm, Homodimer, top, hairpin){
df <- mart_api(primer, shift)
df <- get_filter(df, desired_tm, diff, Heterodimer_tm, Homodimer, hairpin) # unexplained error?
result <- get_multiplex(df, Heterodimer_tm, top)
# Example HTML content
html_template <- paste0(result, collapse = "")
# Split the output string into rows
output_rows <- strsplit(html_template, "-1.000e+06", fixed = TRUE)[[1]]
# Convert rows into a list of elements
output_elements <- strsplit(output_rows, " ")
# Convert list into a matrix
output_matrix <- do
# Display HTML content in RStudio Viewer pane
html_print(output_matrix)
}
findacorn(primer, shift, desired_tm, diff, Heterodimer_tm, Homodimer, top, hairpin)
html_template
output_rows
output_elements
output_matrix
output_matrix
output_elements
View(output_matrix)
do
?do
??do
# Display HTML content in RStudio Viewer pane
html_print(output_elements)
# Display HTML content in RStudio Viewer pane
html_print(output_matrix())
# Display HTML content in RStudio Viewer pane
html_print(output_matrix
}
# Display HTML content in RStudio Viewer pane
html_print(output_matrix)
# Display HTML content in RStudio Viewer pane
html_print(html_template)
# Example HTML content
html_template <- paste0(result, collapse = "")
# Split the output string into rows
output_rows <- strsplit(html_template, "-1.000e+06", fixed = TRUE)[[1]]
output_rows
# Split each row into individual elements
output_elements <- strsplit(output_rows, " ")
output_elements
# Convert the elements into a matrix
output_matrix <- do.call(rbind, output_elements)
output_matrix
# Convert the matrix into a data frame
output_df <- data.frame(output_matrix, stringsAsFactors = FALSE)
output_df
# Generate HTML table
output_table <- kable(output_df, format = "html")
?kable
??kable
library(kableExtra)
library(kableExtra)
??kable
# Generate HTML table
output_table <- kable(output_df, format = "html")
output_table
# Display the table
cat(output_table)
require("kableExtra")
df <- mart_api(primer, shift)
findacorn <- function(primer, shift, desired_tm, diff, Heterodimer_tm, Homodimer, top, hairpin){
df <- mart_api(primer, shift)
df <- get_filter(df, desired_tm, diff, Heterodimer_tm, Homodimer, hairpin) # unexplained error?
result <- get_multiplex(df, Heterodimer_tm, top)
# Example HTML content
html_template <- paste0(result, collapse = "")
# Split the output string into rows
output_rows <- strsplit(html_template, "-1.000e+06", fixed = TRUE)[[1]]
# Split each row into individual elements
output_elements <- strsplit(output_rows, " ")
# Convert the elements into a matrix
output_matrix <- do.call(rbind, output_elements)
# Convert the matrix into a data frame
output_df <- data.frame(output_matrix, stringsAsFactors = FALSE)
# Generate HTML table
output_table <- kable(output_df, format = "html")
# Display the table
cat(output_table)
}
primer = "rs53576, rs1815739, rs7412, rs429358, rs6152"
shift = 100
desired_tm = 64
diff = 3
Heterodimer_tm = 50
Homodimer <- 45
top <- 2
hairpin <- 45
findacorn(primer, shift, desired_tm, diff, Heterodimer_tm, Homodimer, top, hairpin)
html_print(output_table)
output_table
View(output_table)
output_df
View(output_df)
result
# Example HTML content
html_template <- paste0(result)
html_template
# Split the output string into rows
output_rows <- strsplit(html_template, "-1.000e+06", fixed = TRUE)[[1]]
# Split each row into individual elements
output_elements <- strsplit(output_rows, " ")
# Convert the elements into a matrix
output_matrix <- do.call(rbind, output_elements)
# Convert the matrix into a data frame
output_df <- data.frame(output_matrix, stringsAsFactors = FALSE)
# Generate HTML table
output_table <- kable(output_df, format = "html")
# Display the table
cat(output_table)
html_print(output_table)
output_table
output_table
output_df
output_matrix
output_elements
output_rows
html_template
html_print(html_template)
html_template
# Example HTML content
output_matrix <- matrix(result, ncol = 12, byrow = TRUE)
result <- get_multiplex(df, Heterodimer_tm, top)
# Example HTML content
output_matrix <- matrix(result, ncol = 12, byrow = TRUE)
findacorn <- function(primer, shift, desired_tm, diff, Heterodimer_tm, Homodimer, top, hairpin){
df <- mart_api(primer, shift)
df <- get_filter(df, desired_tm, diff, Heterodimer_tm, Homodimer, hairpin) # unexplained error?
result <- get_multiplex(df, Heterodimer_tm, top)
# Example HTML content
output_matrix <- matrix(result, ncol = 12, byrow = TRUE)
# Convert the matrix to a data frame
output_df <- as.data.frame(output_matrix, stringsAsFactors = FALSE)
# Convert the data frame to an HTML table
output_html_table <- htmlTable::htmlTable(output_df, align = "l", rnames = FALSE, caption = "Output Table")
# Print the HTML table
html_print(output_html_table)
}
primer = "rs53576, rs1815739, rs7412, rs429358, rs6152"
shift = 100
desired_tm = 64
diff = 3
Heterodimer_tm = 50
Homodimer <- 45
top <- 2
hairpin <- 45
findacorn(primer, shift, desired_tm, diff, Heterodimer_tm, Homodimer, top, hairpin)
install.packages("htmlTable")
library(htmlTable)
primer = "rs53576, rs1815739, rs7412, rs429358, rs6152"
shift = 100
desired_tm = 64
diff = 3
Heterodimer_tm = 50
Homodimer <- 45
top <- 2
hairpin <- 45
findacorn(primer, shift, desired_tm, diff, Heterodimer_tm, Homodimer, top, hairpin)
